<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title id="site-title">Ù¾Ø®Ø´ Ø§Ø³ØªÙ‚Ù„Ø§Ù„</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
  <style>
    body { font-family: 'Vazirmatn', sans-serif; background-color: #f8f9fa; }
    .product-card {
      transition: all 0.3s ease;
      border-radius: 12px;
      background: white;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      position: relative;
    }
    .product-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 6px 16px rgba(0,0,0,0.15);
    }
    .out-of-stock-badge, .amazing-badge, .bestseller-badge {
      position: absolute;
      top: 8px;
      left: 8px;
      color: white;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.7rem;
      z-index: 10;
      display: flex;
      align-items: center;
      gap: 4px;
    }
    .amazing-badge { background: #dc2626; }
    .bestseller-badge { background: #16a34a; }
    input[type="range"] { direction: ltr; width: 100%; }
    .admin-panel { display: none; }
    #sticky-header {
      position: sticky;
      top: 0;
      z-index: 40;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .theme-blue { --primary: #2563eb; }
    .theme-red { --primary: #dc2626; }
    .theme-green { --primary: #16a34a; }
    .theme-orange { --primary: #f97316; }
    .theme-purple { --primary: #9333ea; }
    .theme-gray { --primary: #1e293b; }
    .btn-primary {
      background-color: var(--primary);
    }
    .btn-primary:hover {
      opacity: 0.9;
    }
    /* Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ */
    #cart-panel {
      position: fixed;
      top: 0;
      right: -400px;
      width: 380px;
      height: 100vh;
      background: white;
      box-shadow: -4px 0 20px rgba(0,0,0,0.2);
      z-index: 1000;
      transition: right 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      overflow-y: auto;
    }
    #cart-panel.open {
      right: 0;
    }
    #cart-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.4);
      z-index: 999;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }
    #cart-overlay.active {
      opacity: 1;
      visibility: visible;
    }
    /* Ø¯Ú©Ù…Ù‡ Ø¨Ø§Ù„Ø§ Ø¨Ø±Ùˆ */
    #scroll-to-top {
      position: fixed;
      bottom: 20px;
      left: 20px;
      width: 50px;
      height: 50px;
      background: var(--primary);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      z-index: 999;
    }
    #scroll-to-top.show {
      opacity: 1;
      visibility: visible;
    }
    .banner {
      background: linear-gradient(135deg, var(--primary), var(--primary));
      color: white;
      padding: 12px;
      border-radius: 8px;
      text-align: center;
      font-weight: 500;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    /* Ø§Ø³ØªÙˆØ±ÛŒ Ù…ÙˆØ´Ù† */
    .motion-story-container {
      height: 200px;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 10px 25px rgba(0,0,0,0.2);
      position: relative;
      margin-bottom: 24px;
    }
    .motion-story-container img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .motion-story-overlay {
      position: absolute;
      bottom: 0;
      right: 0;
      background: rgba(0,0,0,0.7);
      color: white;
      padding: 6px 12px;
      border-radius: 6px 0 0 0;
      font-size: 0.85rem;
      margin: 12px;
    }
    /* Ø§ÛŒÙ…ÙˆØ¬ÛŒ Ù…ØªØ­Ø±Ú© Ø¯ÙˆØ±Ø§Ù†ÛŒ */
    .rotating-emoji {
      font-size: 3rem;
      animation: rotate 8s linear infinite;
      display: block;
      margin: 10px auto;
    }
    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    /* ØªÙ…â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ */
    .theme-preview {
      display: inline-flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 8px;
    }
    .theme-color {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      cursor: pointer;
      border: 2px solid #ddd;
    }
    .theme-color.active {
      border-color: #333;
      transform: scale(1.1);
    }
    .animated-emoji {
      display: inline-block;
      margin-left: 6px;
    }
  </style>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: 'var(--primary, #2563eb)'
          }
        }
      }
    }
  </script>
</head>
<body class="theme-blue">

  <!-- Ù‡Ø¯Ø± Ø«Ø§Ø¨Øª -->
  <header id="sticky-header" class="bg-white">
    <div class="container mx-auto px-4 py-3 flex justify-between items-center">
      <h1 id="header-title" class="text-2xl font-bold text-primary">Ù¾Ø®Ø´ Ø§Ø³ØªÙ‚Ù„Ø§Ù„</h1>
      <div class="flex items-center gap-4">
        <button onclick="openCart()" class="relative">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
          </svg>
          <span id="cart-count" class="absolute -top-2 -left-2 bg-red-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">0</span>
        </button>
        <button onclick="openAdminPanel()" class="text-sm bg-gray-800 text-white px-3 py-1 rounded">Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª</button>
      </div>
    </div>
  </header>

  <!-- Ø§Ø³ØªÙˆØ±ÛŒ Ù…ÙˆØ´Ù† -->
  <div class="container mx-auto px-4">
    <div class="motion-story-container">
      <img id="motion-story" src="https://images.unsplash.com/photo-1607082350899-7e105aa886ae?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80" alt="Ø§Ø³ØªÙˆØ±ÛŒ Ù…ÙˆØ´Ù†">
      <div class="motion-story-overlay">ØªØ§ÛŒÛŒØ¯ Ø´Ø¯Ù‡ âœ…</div>
    </div>
  </div>

  <!-- Ø¨Ù†Ø±Ù‡Ø§ÛŒ ØªØ¨Ù„ÛŒØºØ§ØªÛŒ -->
  <div class="container mx-auto px-4 mb-6">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
      <div class="banner" id="banner1"></div>
      <div class="banner" id="banner2"></div>
      <div class="banner" id="banner3"></div>
    </div>
    <p class="text-center text-sm text-gray-600 mt-2 animate__animated animate__fadeIn">
      <span class="animated-emoji animate__animated animate__pulse">ğŸ“¦</span>
      Ø¯Ø± ØºÛŒØ± Ø§Ø² Ù…Ú©Ø§Ù† Ø´Ù…Ø§ Ø¯Ø± Ø¢Ø°Ø±Ø¨Ø§ÛŒØ¬Ø§Ù† ØºØ±Ø¨ÛŒ. Ú©Ø±Ø§ÛŒÙ‡ Ù…Ø§Ø´ÛŒÙ† Ø§Ø² Ø´Ù…Ø§ Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø¯.
    </p>
  </div>

  <!-- Ø¬Ø³ØªØ¬Ùˆ Ùˆ ÙÛŒÙ„ØªØ± -->
  <div class="container mx-auto px-4 mb-6">
    <div class="flex flex-col md:flex-row gap-4 mb-4">
      <input type="text" id="search" placeholder="Ø¬Ø³ØªØ¬ÙˆÛŒ Ù…Ø­ØµÙˆÙ„..." class="flex-1 border p-2 rounded text-sm" oninput="filterProducts()">
      <select id="category-filter" class="border p-2 rounded text-sm w-full md:w-48" onchange="filterProducts()">
        <option value="">Ù‡Ù…Ù‡ Ø¯Ø³ØªÙ‡â€ŒÙ‡Ø§</option>
        <option value="Ø§Ø³Ù†Ú©">Ø§Ø³Ù†Ú©</option>
        <option value="Ø±ÙˆÚ©Ùˆ">Ø±ÙˆÚ©Ùˆ</option>
        <option value="ÙˆÛŒÙØ±">ÙˆÛŒÙØ±</option>
        <option value="ØªØ®Ù…Ù‡">ØªØ®Ù…Ù‡</option>
        <option value="Ø³Ø§ÛŒØ±">Ø³Ø§ÛŒØ±</option>
      </select>
    </div>
    <div class="w-full">
      <label class="block text-sm mb-1">ÙÛŒÙ„ØªØ± Ù‚ÛŒÙ…Øª (ØªÙˆÙ…Ø§Ù†)</label>
      <div class="flex items-center gap-2">
        <span id="min-price">0</span>
        <input type="range" id="price-range" min="0" max="100000" step="1000" value="100000" oninput="filterProducts()">
        <span id="max-price">100,000</span>
      </div>
    </div>
  </div>

  <!-- Ø¯Ú©Ù…Ù‡ Ø¬ÙˆØ§ÛŒØ² -->
  <div class="container mx-auto px-4 mb-6 text-center">
    <button disabled title="Ø¯Ø± Ø¢ÛŒÙ†Ø¯Ù‡ ÙØ¹Ø§Ù„ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯: Ø¨Ø§ Ø®Ø±ÛŒØ¯ Ù…Ø­ØµÙˆÙ„Ø§ØªØŒ Ø§Ù…ØªÛŒØ§Ø² Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ú©Ù†ÛŒØ¯ Ùˆ Ø¬ÙˆØ§ÛŒØ² Ø¯Ø±ÛŒØ§ÙØª Ú©Ù†ÛŒØ¯!" 
            class="bg-gray-300 text-gray-600 px-4 py-2 rounded-full text-sm cursor-not-allowed animate__animated animate__fadeIn">
      <span class="animated-emoji animate__animated animate__bounce">ğŸ</span>
      Ø¬ÙˆØ§ÛŒØ²
    </button>
    <div class="rotating-emoji">ğŸŒŸ</div>
  </div>

  <!-- Ø¨Ø®Ø´â€ŒÙ‡Ø§ÛŒ ÙˆÛŒÚ˜Ù‡ -->
  <div class="container mx-auto px-4 mb-8">
    <div id="amazing-section" class="hidden">
      <h2 id="amazing-title" class="text-xl font-bold mb-3"></h2>
      <div id="amazing-products" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-5 mb-8"></div>
    </div>

    <div id="bestsellers-section" class="hidden">
      <h2 id="bestsellers-title" class="text-xl font-bold mb-3"></h2>
      <div id="bestsellers" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-5 mb-8"></div>
    </div>
  </div>

  <!-- Ù‡Ù…Ù‡ Ù…Ø­ØµÙˆÙ„Ø§Øª -->
  <div class="container mx-auto px-4 pb-10">
    <h2 id="all-products-title" class="text-xl font-bold text-gray-800 mb-4"></h2>
    <div id="product-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-5"></div>
  </div>

  <!-- ÙÙˆØªØ± -->
  <footer class="bg-gray-800 text-white text-center py-4 mt-10">
    <div id="social-links" class="mb-2"></div>
    <p>Â© 1404 Ù¾Ø®Ø´ Ø§Ø³ØªÙ‚Ù„Ø§Ù„</p>
  </footer>

  <!-- Ø¯Ú©Ù…Ù‡ Ø¨Ø§Ù„Ø§ Ø¨Ø±Ùˆ -->
  <div id="scroll-to-top" onclick="scrollToTop()">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="white">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7" />
    </svg>
  </div>

  <!-- Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ -->
  <div id="cart-overlay" onclick="closeCart()"></div>
  <div id="cart-panel">
    <div class="p-4 border-b flex justify-between items-center">
      <h2 class="text-lg font-bold">Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯</h2>
      <button onclick="closeCart()" class="text-gray-500 hover:text-gray-800">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>
    <div id="cart-items" class="p-4"></div>
    <div class="p-4 border-t">
      <div class="flex justify-between text-lg font-bold mb-4">
        <span>Ø¬Ù…Ø¹ Ú©Ù„:</span>
        <span id="cart-total">0 ØªÙˆÙ…Ø§Ù†</span>
      </div>
      <button onclick="proceedToCheckout()" class="w-full bg-primary text-white py-2 rounded btn-primary hover:bg-opacity-90">
        Ø§Ø¯Ø§Ù…Ù‡ ÙØ±Ø¢ÛŒÙ†Ø¯ Ø®Ø±ÛŒØ¯
      </button>
    </div>
  </div>

  <!-- Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª -->
  <div id="admin-panel" class="admin-panel fixed inset-0 bg-white z-50 p-6 overflow-auto">
    <div class="max-w-6xl mx-auto">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold">Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª â€” ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ú©Ù„ÛŒ</h2>
        <button onclick="closeAdminPanel()" class="bg-gray-200 px-3 py-1 rounded">Ø¨Ø³ØªÙ†</button>
      </div>

      <div class="mb-6 p-4 border rounded bg-gray-50">
        <h3 class="font-bold mb-3">Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØªÙ…Ø§Ø³</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-3">
          <input type="text" id="company-name" placeholder="Ù†Ø§Ù… Ø´Ø±Ú©Øª" class="border p-2">
          <input type="text" id="ceo-name" placeholder="Ù†Ø§Ù… Ù…Ø¯ÛŒØ± Ø¹Ø§Ù…Ù„" class="border p-2">
          <input type="text" id="phone-number" placeholder="Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³ Ø§ØµÙ„ÛŒ" class="border p-2">
          <input type="text" id="phone-number2" placeholder="Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³ Ø«Ø§Ø¨Øª Ø¯ÙˆÙ…" class="border p-2">
        </div>

        <h4 class="font-bold mt-4 mb-2">Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ Ù…Ù‡Ù…</h4>
        <div class="grid grid-cols-1 gap-3">
          <input type="text" id="order-link" placeholder="Ù„ÛŒÙ†Ú© Ø³ÙØ§Ø±Ø´ (ÙˆØ§ØªØ³Ø§Ù¾ ÛŒØ§ Ø³Ø§ÛŒØ±)" class="border p-2">
          <input type="text" id="contact-link" placeholder="Ù„ÛŒÙ†Ú© Ø§Ø±ØªØ¨Ø§Ø·ÛŒ (ØªÙ„Ú¯Ø±Ø§Ù…/Ø§ÛŒÙ†Ø³ØªØ§Ú¯Ø±Ø§Ù…)" class="border p-2">
        </div>

        <h4 class="font-bold mt-4 mb-2">Ø§Ø³ØªÙˆØ±ÛŒ Ù…ÙˆØ´Ù†</h4>
        <div class="flex items-center gap-3 mb-4">
          <input type="file" accept="image/*" id="story-upload" onchange="uploadStoryImage(event)" class="text-sm">
          <img id="story-preview" src="" alt="Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´" class="w-16 h-16 object-cover rounded border" style="display:none;">
        </div>

        <h4 class="font-bold mt-4 mb-2">Ø¸Ø§Ù‡Ø± Ø³Ø§ÛŒØª</h4>
        <select id="theme-select" class="border p-2 w-full mb-2" onchange="previewTheme(this.value)">
          <option value="blue">Ø¢Ø¨ÛŒ</option>
          <option value="red">Ù‚Ø±Ù…Ø²</option>
          <option value="green">Ø³Ø¨Ø²</option>
          <option value="orange">Ù†Ø§Ø±Ù†Ø¬ÛŒ</option>
          <option value="purple">Ø¨Ù†ÙØ´</option>
          <option value="gray">Ù…Ø´Ú©ÛŒ</option>
        </select>
        <div class="theme-preview">
          <div class="theme-color" style="background:#2563eb" onclick="setTheme('blue')" title="Ø¢Ø¨ÛŒ"></div>
          <div class="theme-color" style="background:#dc2626" onclick="setTheme('red')" title="Ù‚Ø±Ù…Ø²"></div>
          <div class="theme-color" style="background:#16a34a" onclick="setTheme('green')" title="Ø³Ø¨Ø²"></div>
          <div class="theme-color" style="background:#f97316" onclick="setTheme('orange')" title="Ù†Ø§Ø±Ù†Ø¬ÛŒ"></div>
          <div class="theme-color" style="background:#9333ea" onclick="setTheme('purple')" title="Ø¨Ù†ÙØ´"></div>
          <div class="theme-color" style="background:#1e293b" onclick="setTheme('gray')" title="Ù…Ø´Ú©ÛŒ"></div>
        </div>

        <button onclick="saveGeneralSettings()" class="mt-3 bg-primary text-white px-4 py-2 rounded btn-primary">Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª</button>
      </div>

      <div class="mb-6">
        <div class="flex justify-between items-center mb-3">
          <h3 class="font-bold">Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø­ØµÙˆÙ„Ø§Øª</h3>
          <button onclick="addNewProduct()" class="bg-green-600 text-white px-3 py-1 rounded text-sm">Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø­ØµÙˆÙ„ Ø¬Ø¯ÛŒØ¯</button>
        </div>
        <div id="admin-products" class="space-y-3 max-h-96 overflow-y-auto p-2 border rounded"></div>
      </div>
    </div>
  </div>

  <script>
    // === ØªØ§Ø¨Ø¹ Ø§ÛŒÙ…ÙˆØ¬ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯ ===
    function getEmojiForText(text) {
      const lower = text.toLowerCase();
      if (lower.includes("Ø§Ø±Ø³Ø§Ù„") || lower.includes("Ù…Ø§Ø´ÛŒÙ†")) return "ğŸšš";
      if (lower.includes("Ù†Ù…Ø§ÛŒÙ†Ø¯Ú¯ÛŒ") || lower.includes("Ø±Ø³Ù…ÛŒ")) return "ğŸ…";
      if (lower.includes("Ú©ÛŒÙÛŒØª") || lower.includes("Ù‚ÛŒÙ…Øª")) return "ğŸ’¯";
      if (lower.includes("Ø¬ÙˆØ§ÛŒØ²")) return "ğŸ";
      if (lower.includes("Ø´Ú¯ÙØª")) return "ğŸ”¥";
      if (lower.includes("Ù¾Ø±ÙØ±ÙˆØ´")) return "â­";
      if (lower.includes("Ø§Ø³Ù†Ú©") || lower.includes("Ø±ÙˆÚ©Ùˆ") || lower.includes("ÙˆÛŒÙØ±") || lower.includes("ØªØ®Ù…Ù‡")) return "ğŸ¿";
      if (lower.includes("ØªÙ…Ø§Ø³") || lower.includes("Ø´Ù…Ø§Ø±Ù‡")) return "ğŸ“";
      if (lower.includes("Ù…Ø­ØµÙˆÙ„Ø§Øª")) return "ğŸ›ï¸";
      return "âœ¨";
    }

    function addAnimatedEmoji(text) {
      const emoji = getEmojiForText(text);
      return `<span class="animated-emoji animate__animated animate__bounce">${emoji}</span> ${text}`;
    }

    // === Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± ===
    function getCategory(name) {
      if (name.includes("Ø±ÙˆÚ©Ùˆ")) return "Ø±ÙˆÚ©Ùˆ";
      if (name.includes("ÙˆÛŒÙØ±") || (name.includes("ÙÙ„Ù‡") && !name.includes("ØªØ®Ù…Ù‡"))) return "ÙˆÛŒÙØ±";
      if (name.includes("ØªØ®Ù…Ù‡")) return "ØªØ®Ù…Ù‡";
      if (name.includes("Ø§Ø³Ù†Ú©") || name.includes("ÙÛŒÙ„ÛŒ") || name.includes("Ø­Ù„Ù‚Ù‡") || name.includes("Ø®Ù„Ø§Ù„ÛŒ") || 
          name.includes("Ù¾ÙÚ©") || name.includes("Ú†Ø±Ø®ÛŒ") || name.includes("Ø¯ÙˆØ±Ù‡") || name.includes("Ù¾Ø°ÛŒØ±Ø§ÛŒÛŒ") || 
          name.includes("Ú©Ù„Ø§Ø³ÛŒÚ©")) return "Ø§Ø³Ù†Ú©";
      return "Ø³Ø§ÛŒØ±";
    }

    // === Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ø§Ø² ÙØ§ÛŒÙ„ Ø§Ú©Ø³Ù„ Ø´Ù…Ø§ ===
    const initialProducts = [
      { name: "Ø§Ø³Ù†Ú© Ø­Ù„Ù‚Ù‡ Ø§ÛŒ Ù¾Ù†ÛŒØ±ÛŒ Ø¨Ø²Ø±Ú¯", code: "1126", price: "48000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1126.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "Ø§Ø³Ù†Ú© Ø­Ù„Ù‚Ù‡ Ø§ÛŒ Ù¾ÛŒØ§Ø² Ø¬Ø¹ÙØ±ÛŒ Ø®Ø§Ù†ÙˆØ§Ø¯Ù‡", code: "1125", price: "70000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1125.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "Ø§Ø³Ù†Ú© Ø¯ÙˆØ±Ù‡ Ù‡Ù…ÛŒ", code: "1124", price: "58000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1124.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "Ø§Ø³Ù†Ú© Ø·Ù„Ø§ÛŒÛŒ Ø®Ø§Ù†ÙˆØ§Ø¯Ù‡ Ø§Ø´ÛŒ Ù…Ø´ÛŒ", code: "1103", price: "75000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1103.jpg", outOfStock: false, amazing: true, bestseller: true },
      { name: "Ø§Ø³Ù†Ú© Ø·Ù„Ø§ÛŒÛŒ Ù¾Ø°ÛŒØ±Ø§ÛŒÛŒ Ø§Ø´ÛŒ Ù…Ø´ÛŒ", code: "1104", price: "32000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1104.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "Ø§Ø³Ù†Ú© Ù¾ÙÚ© Ù‡Ù†Ø¯ÛŒ Ù†Ù…Ú©ÛŒ", code: "1141", price: "44000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1141.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "Ø§Ø³Ù†Ú© Ù¾ÙÚ© Ù‡Ù†Ø¯ÛŒ Ù¾Ù†ÛŒØ±ÛŒ", code: "1140", price: "44000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1140.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "Ø§Ø³Ù†Ú© Ú†Ø±Ø®ÛŒ Ø¨Ø²Ø±Ú¯", code: "1122", price: "46000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1122.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "Ø§Ø³Ù†Ú© Ú†Ø±Ø®ÛŒ Ø®Ø§Ù†ÙˆØ§Ø¯Ù‡", code: "1123", price: "67000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1123.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "Ø§Ø³Ù†Ú© Ú©Ù„Ø§Ø³ÛŒÚ© Ø¨Ø²Ø±Ú¯ Ø§Ø´ÛŒ Ù…Ø´ÛŒ", code: "1101", price: "52000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1101.jpg", outOfStock: false, amazing: true, bestseller: true },
      { name: "Ø§Ø³Ù†Ú© Ú©Ù„Ø§Ø³ÛŒÚ© Ø®Ø§Ù†ÙˆØ§Ø¯Ù‡ Ø§Ø´ÛŒ Ù…Ø´ÛŒ", code: "1102", price: "72000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1102.jpg", outOfStock: false, amazing: false, bestseller: true },
      { name: "Ø§Ø³Ù†Ú© Ú©Ù„Ø§Ø³ÛŒÚ© Ù…ØªÙˆØ³Ø· Ù¾ÙÚ© Ø§Ø´ÛŒ Ù…Ø´ÛŒ", code: "1100", price: "45000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1100.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "ØªØ®Ù…Ù‡ ÙÙ„Ù‡ Ø³Ø§Ø¯Ù‡", code: "1143", price: "88000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1143.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "ØªØ®Ù…Ù‡ ÙÙ„Ù‡ ÙÙ„ÙÙ„ÛŒ", code: "1146", price: "92000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1146.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "ØªØ®Ù…Ù‡ ÙÙ„Ù‡ Ù„ÛŒÙ…ÙˆÛŒÛŒ", code: "1145", price: "92000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1145.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "ØªØ®Ù…Ù‡ ÙÙ„Ù‡ Ù¾Ù†ÛŒØ±ÛŒ", code: "1144", price: "92000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1144.jpg", outOfStock: false, amazing: true, bestseller: true },
      { name: "ØªØ®Ù…Ù‡ ÙÙ„Ù‡ Ù¾ÛŒØ§Ø² Ø¬Ø¹ÙØ±ÛŒ", code: "1147", price: "92000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1147.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "ØªØ®Ù…Ù‡ ÙÙ„Ù‡ Ú©Ù¾Ø§Ù¾", code: "1142", price: "95000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1142.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "ØªØ®Ù…Ù‡ Ú©Ø¯ÙˆÙÙ„Ù‡ Ú¯ÙˆØ´ØªÛŒ", code: "1148", price: "98000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1148.jpg", outOfStock: false, amazing: true, bestseller: false },
      { name: "Ø­Ù„Ù‚Ù‡ Ø§ÛŒ Ù¾Ù†ÛŒØ±ÛŒ Ø®Ø§Ù†ÙˆØ§Ø¯Ù‡ Ø§Ø´ÛŒ Ù…Ø´ÛŒ", code: "1108", price: "69000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1108.jpg", outOfStock: false, amazing: true, bestseller: false },
      { name: "Ø®Ù„Ø§Ù„ÛŒ Ú©Ú†Ø§Ù¾ Ø¨Ø²Ø±Ú¯ Ø§Ø´ÛŒ Ù…Ø´ÛŒ", code: "1109", price: "55000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1109.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "Ø±ÙˆÚ©Ùˆ Ù…Ø§Ø³Øª Ù…ÙˆØ³ÛŒØ±", code: "1120", price: "28000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1120.jpg", outOfStock: false, amazing: false, bestseller: true },
      { name: "Ø±ÙˆÚ©Ùˆ Ù…Ú©Ø²ÛŒÚ©ÛŒ", code: "1118", price: "28000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1118.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "Ø±ÙˆÚ©Ùˆ Ù¾Ù†ÛŒØ±ÛŒ", code: "1119", price: "28000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1119.jpg", outOfStock: false, amazing: true, bestseller: true },
      { name: "Ø±ÙˆÚ©Ùˆ Ú©Ú†Ø§Ù¾ Ø°Ø±Øª Ú©Ø§Ù†ÛŒÚ©Ø§Ù„", code: "1117", price: "28000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1117.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "Ø´Ù‡Ø± Ø³Ø¨Ø² ÙˆÛŒÙØ± ÙÙ„Ù‡ ØªÙˆØª ÙØ±Ù†Ú¯ÛŒ", code: "1116", price: "38000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1116.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "Ø´ÛŒØ±ÛŒÙ† Ú¯Ù†Ø¯Ù…Ú©", code: "1121", price: "35000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1121.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "ØºÙ„Ø§Øª ØµØ¨Ø­Ø§Ù†Ù‡ Ù…ØºØ² Ø¯Ø§Ø± Ø§Ø´ÛŒ Ù…Ø´ÛŒ", code: "1110", price: "42000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1110.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "ÙÙ„Ù‡ Ù¾Ø³ØªÙ‡", code: "1130", price: "85000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1130.jpg", outOfStock: false, amazing: true, bestseller: true },
      { name: "ÙÛŒÙ„ÛŒ Ù¾Ø§Ù¾ Ø¨Ø²Ø±Ú¯", code: "1105", price: "48000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1105.jpg", outOfStock: false, amazing: false, bestseller: true },
      { name: "ÙÛŒÙ„ÛŒ Ù¾Ø§Ù¾ Ø®Ø§Ù†ÙˆØ§Ø¯Ù‡", code: "1106", price: "65000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1106.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "ÙˆÛŒÙØ± ÙÙ„Ù‡ Ù…ÙˆØ²", code: "1129", price: "36000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1129.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "ÙˆÛŒÙØ± ÙÙ„Ù‡ Ù¾Ø±ØªØºØ§Ù„ÛŒ", code: "1132", price: "36000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1132.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "ÙˆÛŒÙØ± ÙÙ„Ù‡ Ú©Ø§Ú©Ø§Ø¦Ùˆ", code: "1133", price: "36000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1133.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "Ù¾ÛŒØ§Ø² Ø¬Ø¹ÙØ±ÛŒ Ø¨Ø²Ø±Ú¯ Ø§Ø´ÛŒ Ù…Ø´ÛŒ", code: "1107", price: "50000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1107.jpg", outOfStock: false, amazing: false, bestseller: false },
      { name: "Ú©Ù„Ø§Ø³ÛŒÚ© Ù¾Ø°ÛŒØ±Ø§ÛŒÛŒ", code: "1138", price: "30000", img: "https://ashimashi.co.ir/wp-content/uploads/2023/08/1138.jpg", outOfStock: false, amazing: false, bestseller: false }
    ];

    // === Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ ===
    let siteSettings = JSON.parse(localStorage.getItem('siteSettings')) || {
      companyName: "Ù¾Ø®Ø´ Ø§Ø³ØªÙ‚Ù„Ø§Ù„",
      ceoName: "Ø´Ø§Ù‡ÛŒÙ† Ø¹Ø«Ù…Ø§Ù† ÙˆØ´",
      phoneNumber: "09142961752",
      phoneNumber2: "",
      orderLink: "https://wa.me/989142961752",
      contactLink: "",
      theme: "blue",
      storyImage: "https://images.unsplash.com/photo-1607082350899-7e105aa886ae?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80"
    };
    let products = JSON.parse(localStorage.getItem('products')) || initialProducts;
    let cart = JSON.parse(localStorage.getItem('cart')) || [];

    // === Ø§Ø¹Ù…Ø§Ù„ ØªÙ†Ø¸ÛŒÙ…Ø§Øª ===
    function applySettings() {
      document.getElementById('site-title').textContent = siteSettings.companyName;
      document.getElementById('header-title').textContent = siteSettings.companyName;
      document.body.className = `theme-${siteSettings.theme}`;

      // Ø¨Ù†Ø±Ù‡Ø§
      document.getElementById('banner1').innerHTML = addAnimatedEmoji("Ù†Ù…Ø§ÛŒÙ†Ø¯Ú¯ÛŒ Ø±Ø³Ù…ÛŒ Ø§Ø³Ù†Ú©â€ŒÙ‡Ø§ÛŒ Ø§Ø´ÛŒ Ù…Ø´ÛŒ");
      document.getElementById('banner2').innerHTML = addAnimatedEmoji("Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ Ú©Ù„ Ø¢Ø°Ø±Ø¨Ø§ÛŒØ¬Ø§Ù† ØºØ±Ø¨ÛŒ");
      document.getElementById('banner3').innerHTML = addAnimatedEmoji("Ø¨Ø§Ù„Ø§ØªØ±ÛŒÙ† Ú©ÛŒÙÛŒØªØŒ Ù…Ù†Ø§Ø³Ø¨â€ŒØªØ±ÛŒÙ† Ù‚ÛŒÙ…Øª");

      // Ø¹Ù†Ø§ÙˆÛŒÙ†
      document.getElementById('amazing-title').innerHTML = addAnimatedEmoji("Ø´Ú¯ÙØªâ€ŒØ§Ù†Ú¯ÛŒØ²Ù‡Ø§");
      document.getElementById('bestsellers-title').innerHTML = addAnimatedEmoji("Ù¾Ø±ÙØ±ÙˆØ´â€ŒÙ‡Ø§");
      document.getElementById('all-products-title').innerHTML = addAnimatedEmoji("Ù‡Ù…Ù‡ Ù…Ø­ØµÙˆÙ„Ø§Øª");

      // ÙÙˆØªØ±
      let socialHTML = '';
      if (siteSettings.contactLink) {
        socialHTML = `<a href="${siteSettings.contactLink}" target="_blank" class="text-white underline">${addAnimatedEmoji("Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ù…Ø§")}</a>`;
      }
      document.getElementById('social-links').innerHTML = socialHTML;

      // Ø§Ø³ØªÙˆØ±ÛŒ
      document.getElementById('motion-story').src = siteSettings.storyImage;
    }

    // === Ù†Ù…Ø§ÛŒØ´ Ù…Ø­ØµÙˆÙ„Ø§Øª ===
    function renderProducts(list = products) {
      const allGrid = document.getElementById('product-grid');
      const amazingGrid = document.getElementById('amazing-products');
      const bestsellersGrid = document.getElementById('bestsellers');
      const amazingSection = document.getElementById('amazing-section');
      const bestsellersSection = document.getElementById('bestsellers-section');

      allGrid.innerHTML = '';
      amazingGrid.innerHTML = '';
      bestsellersGrid.innerHTML = '';

      let hasAmazing = false, hasBestsellers = false;

      list.forEach(p => {
        const card = createProductCard(p);
        allGrid.appendChild(card);
        if (p.amazing) {
          amazingGrid.appendChild(createProductCard(p));
          hasAmazing = true;
        }
        if (p.bestseller) {
          bestsellersGrid.appendChild(createProductCard(p));
          hasBestsellers = true;
        }
      });

      amazingSection.classList.toggle('hidden', !hasAmazing);
      bestsellersSection.classList.toggle('hidden', !hasBestsellers);

      updateCartUI();
    }

    function createProductCard(p) {
      const div = document.createElement('div');
      div.className = 'product-card';

      let badge = '';
      if (p.outOfStock) {
        badge = `<div class="out-of-stock-badge">Ø§ØªÙ…Ø§Ù… Ù…ÙˆØ¬ÙˆØ¯ÛŒ</div>`;
      } else if (p.amazing) {
        badge = `<div class="amazing-badge">ğŸ”¥ Ø´Ú¯ÙØªâ€ŒØ§Ù†Ú¯ÛŒØ²</div>`;
      } else if (p.bestseller) {
        badge = `<div class="bestseller-badge">â­ Ù¾Ø±ÙØ±ÙˆØ´</div>`;
      }

      const btnText = p.outOfStock ? 'Ø§ØªÙ…Ø§Ù… Ù…ÙˆØ¬ÙˆØ¯ÛŒ' : 'Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯';
      const btnClass = p.outOfStock ? 'bg-gray-400 cursor-not-allowed' : 'btn-primary hover:bg-opacity-90';

      div.innerHTML = badge + `
        <div class="h-36 bg-white flex items-center justify-center">
          <img src="${p.img}" alt="${p.name}" class="max-h-full max-w-full object-contain p-2"
               onerror="this.style.display='none'; this.parentElement.innerHTML='<div class=\'text-xs text-center text-gray-500\'>Ø¹Ú©Ø³ Ù†Ø§Ù…ÙˆØ¬ÙˆØ¯</div>';">
        </div>
        <div class="p-2">
          <h3 class="text-xs font-medium text-gray-800 line-clamp-2 mb-1">${p.name}</h3>
          <p class="text-xs text-gray-500">Ú©Ø¯: ${p.code}</p>
          <p class="text-lg font-bold text-red-600 mt-1">${parseInt(p.price).toLocaleString()} ØªÙˆÙ…Ø§Ù†</p>
          <button ${p.outOfStock ? 'disabled' : `onclick="addToCart(${JSON.stringify(p).replace(/"/g, '&quot;')})"`} class="mt-2 w-full text-white text-xs py-1.5 rounded ${btnClass}">
            ${btnText}
          </button>
        </div>
      `;
      return div;
    }

    // === Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ ===
    function addToCart(product) {
      if (product.outOfStock) return;
      const existing = cart.find(item => item.code === product.code);
      if (existing) {
        existing.quantity += 1;
      } else {
        cart.push({ ...product, quantity: 1 });
      }
      saveCart();
      updateCartUI();
      openCart();
    }

    function updateCartUI() {
      const count = cart.reduce((sum, item) => sum + item.quantity, 0);
      document.getElementById('cart-count').textContent = count;

      const itemsDiv = document.getElementById('cart-items');
      if (!document.getElementById('cart-panel').classList.contains('open')) return;

      if (cart.length === 0) {
        itemsDiv.innerHTML = '<p class="text-center text-gray-500 py-6">Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª.</p>';
        document.getElementById('cart-total').textContent = '0 ØªÙˆÙ…Ø§Ù†';
        return;
      }

      let html = '';
      let total = 0;
      cart.forEach(item => {
        const itemTotal = parseInt(item.price) * item.quantity;
        total += itemTotal;
        html += `
          <div class="flex items-center gap-3 mb-4 p-2 border rounded">
            <img src="${item.img}" class="w-12 h-12 object-contain" onerror="this.style.display='none'">
            <div class="flex-1">
              <h4 class="text-sm font-medium">${item.name}</h4>
              <p class="text-xs text-gray-500">${parseInt(item.price).toLocaleString()} ØªÙˆÙ…Ø§Ù†</p>
            </div>
            <div class="flex items-center gap-2">
              <button onclick="changeQuantity('${item.code}', -1)" class="w-6 h-6 rounded-full bg-gray-200">-</button>
              <span>${item.quantity}</span>
              <button onclick="changeQuantity('${item.code}', 1)" class="w-6 h-6 rounded-full bg-gray-200">+</button>
            </div>
          </div>
        `;
      });
      itemsDiv.innerHTML = html;
      document.getElementById('cart-total').textContent = total.toLocaleString() + ' ØªÙˆÙ…Ø§Ù†';
    }

    function changeQuantity(code, delta) {
      const item = cart.find(i => i.code === code);
      if (item) {
        item.quantity += delta;
        if (item.quantity <= 0) {
          cart = cart.filter(i => i.code !== code);
        }
        saveCart();
        updateCartUI();
      }
    }

    function proceedToCheckout() {
      if (cart.length === 0) return;
      const url = siteSettings.orderLink;
      window.open(url, '_blank');
      cart = [];
      saveCart();
      updateCartUI();
    }

    function openCart() {
      document.getElementById('cart-panel').classList.add('open');
      document.getElementById('cart-overlay').classList.add('active');
      updateCartUI();
    }

    function closeCart() {
      document.getElementById('cart-panel').classList.remove('open');
      document.getElementById('cart-overlay').classList.remove('active');
    }

    function saveCart() {
      localStorage.setItem('cart', JSON.stringify(cart));
    }

    // === Ø§Ø³Ú©Ø±ÙˆÙ„ ===
    window.addEventListener('scroll', () => {
      const btn = document.getElementById('scroll-to-top');
      if (window.scrollY > 300) {
        btn.classList.add('show');
      } else {
        btn.classList.remove('show');
      }
    });

    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // === ÙÛŒÙ„ØªØ± ===
    function filterProducts() {
      const query = document.getElementById('search').value.toLowerCase();
      const category = document.getElementById('category-filter').value;
      const maxPrice = parseInt(document.getElementById('price-range').value) || 100000;

      const filtered = products.filter(p =>
        p.name.toLowerCase().includes(query) &&
        (category === '' || getCategory(p.name) === category) &&
        parseInt(p.price) <= maxPrice
      );
      renderProducts(filtered);
      document.getElementById('max-price').textContent = maxPrice.toLocaleString();
    }

    // === Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª ===
    function openAdminPanel() {
      const pass = prompt('Ø±Ù…Ø² Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:');
      if (pass === (localStorage.getItem('adminPass') || 'admin123')) {
        document.getElementById('admin-panel').style.display = 'block';
        
        document.getElementById('company-name').value = siteSettings.companyName;
        document.getElementById('ceo-name').value = siteSettings.ceoName;
        document.getElementById('phone-number').value = siteSettings.phoneNumber;
        document.getElementById('phone-number2').value = siteSettings.phoneNumber2 || '';
        document.getElementById('order-link').value = siteSettings.orderLink;
        document.getElementById('contact-link').value = siteSettings.contactLink || '';
        document.getElementById('theme-select').value = siteSettings.theme;
        
        // Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ø§Ø³ØªÙˆØ±ÛŒ
        if (siteSettings.storyImage) {
          document.getElementById('story-preview').src = siteSettings.storyImage;
          document.getElementById('story-preview').style.display = 'block';
        }
        
        renderAdminPanel();
      } else {
        alert('Ø±Ù…Ø² Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª!');
      }
    }

    function closeAdminPanel() {
      document.getElementById('admin-panel').style.display = 'none';
    }

    function previewTheme(theme) {
      document.body.className = `theme-${theme}`;
    }

    function setTheme(theme) {
      document.getElementById('theme-select').value = theme;
      previewTheme(theme);
      document.querySelectorAll('.theme-color').forEach(el => el.classList.remove('active'));
      event.target.classList.add('active');
    }

    function saveGeneralSettings() {
      siteSettings = {
        companyName: document.getElementById('company-name').value || "Ù¾Ø®Ø´ Ø§Ø³ØªÙ‚Ù„Ø§Ù„",
        ceoName: document.getElementById('ceo-name').value || "Ù…Ø¯ÛŒØ± Ø¹Ø§Ù…Ù„",
        phoneNumber: document.getElementById('phone-number').value || "09142961752",
        phoneNumber2: document.getElementById('phone-number2').value || "",
        orderLink: document.getElementById('order-link').value || "https://wa.me/989142961752",
        contactLink: document.getElementById('contact-link').value || "",
        theme: document.getElementById('theme-select').value,
        storyImage: siteSettings.storyImage
      };
      localStorage.setItem('siteSettings', JSON.stringify(siteSettings));
      applySettings();
      alert('ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯.');
    }

    function uploadStoryImage(event) {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          siteSettings.storyImage = e.target.result;
          localStorage.setItem('siteSettings', JSON.stringify(siteSettings));
          document.getElementById('motion-story').src = e.target.result;
          document.getElementById('story-preview').src = e.target.result;
          document.getElementById('story-preview').style.display = 'block';
          alert("Ø¹Ú©Ø³ Ø§Ø³ØªÙˆØ±ÛŒ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¢Ù¾Ù„ÙˆØ¯ Ø´Ø¯!");
        };
        reader.readAsDataURL(file);
      }
    }

    function renderAdminPanel() {
      const container = document.getElementById('admin-products');
      container.innerHTML = '';
      products.forEach((p, index) => {
        const div = document.createElement('div');
        div.className = 'p-3 border rounded bg-white flex flex-wrap gap-2 items-start';
        div.innerHTML = `
          <input type="text" value="${p.name}" onchange="updateField(${index}, 'name', this.value)" class="border p-1 w-full text-sm" placeholder="Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„">
          <div class="flex gap-2 w-full">
            <input type="text" value="${p.code}" onchange="updateField(${index}, 'code', this.value)" class="border p-1 w-20 text-sm" placeholder="Ú©Ø¯">
            <input type="number" value="${p.price}" onchange="updateField(${index}, 'price', this.value)" class="border p-1 w-24 text-sm" placeholder="Ù‚ÛŒÙ…Øª">
            <div class="flex-1 flex gap-1">
              <input type="file" accept="image/*" onchange="uploadImage(event, ${index})" class="text-xs">
            </div>
          </div>
          <div class="flex gap-2 mt-1">
            <label><input type="checkbox" ${p.outOfStock ? 'checked' : ''} onchange="toggleStock(${index}, this.checked)"> Ø§ØªÙ…Ø§Ù… Ù…ÙˆØ¬ÙˆØ¯ÛŒ</label>
            <label><input type="checkbox" ${p.amazing ? 'checked' : ''} onchange="toggleAmazing(${index}, this.checked)"> Ø´Ú¯ÙØªâ€ŒØ§Ù†Ú¯ÛŒØ²</label>
            <label><input type="checkbox" ${p.bestseller ? 'checked' : ''} onchange="toggleBestseller(${index}, this.checked)"> Ù¾Ø±ÙØ±ÙˆØ´</label>
          </div>
        `;
        container.appendChild(div);
      });
    }

    function uploadImage(event, index) {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          products[index].img = e.target.result;
          saveProducts();
          const allCards = document.querySelectorAll('.product-card');
          if (allCards[index]) {
            const imgEl = allCards[index].querySelector('img');
            if (imgEl) {
              imgEl.src = e.target.result;
              imgEl.style.display = 'block';
              const placeholder = imgEl.parentElement.querySelector('.text-gray-500');
              if (placeholder) placeholder.remove();
            }
          }
          alert("Ø¹Ú©Ø³ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¢Ù¾Ù„ÙˆØ¯ Ø´Ø¯!");
        };
        reader.readAsDataURL(file);
      }
    }

    function addNewProduct() {
      products.push({ 
        name: "Ù…Ø­ØµÙˆÙ„ Ø¬Ø¯ÛŒØ¯", 
        code: "0000", 
        price: "0", 
        img: "https://via.placeholder.com/150?text=Ø¹Ú©Ø³+Ù…Ø­ØµÙˆÙ„", 
        outOfStock: false,
        amazing: false,
        bestseller: false
      });
      saveProducts();
    }

    function updateField(index, field, value) {
      if (value.trim() !== '') {
        products[index][field] = value.trim();
        saveProducts();
      }
    }

    function toggleStock(index, checked) {
      products[index].outOfStock = checked;
      saveProducts();
    }

    function toggleAmazing(index, checked) {
      products[index].amazing = checked;
      saveProducts();
    }

    function toggleBestseller(index, checked) {
      products[index].bestseller = checked;
      saveProducts();
    }

    function saveProducts() {
      localStorage.setItem('products', JSON.stringify(products));
      renderProducts();
      renderAdminPanel();
    }

    // === Ø´Ø±ÙˆØ¹ ===
    applySettings();
    renderProducts();
  </script>
</body>
</html>